# modules/pamyat.py
# üß† –ú–æ–¥—É–ª—å –ü–∞–º—è—Ç–∏ ‚Äì –•—Ä–æ–Ω–∏–∫–∏ –û–ø—ã—Ç–æ–≤ –î—É—à

from core.ra_memory import memory
from datetime import datetime


class –•—Ä–æ–Ω–∏–∫–∏:
    """–õ–µ—Ç–æ–ø–∏—Å–µ—Ü –æ–ø—ã—Ç–∞ –ò—Å–∫—Ä—ã. –ù–µ —Ö—Ä–∞–Ω–∏—Ç —Å–∞–º ‚Äî –ø–µ—Ä–µ–¥–∞—ë—Ç –≤ RaMemory."""

    def __init__(self, source="–•—Ä–æ–Ω–∏–∫–∏"):
        self.source = source

    async def –¥–æ–±–∞–≤–∏—Ç—å(self, –æ–ø—ã—Ç, user_id="shared", layer="auto"):
        """
        –î–æ–±–∞–≤–ª—è–µ—Ç –æ–ø—ã—Ç –≤ –æ—Å–Ω–æ–≤–Ω—É—é –ø–∞–º—è—Ç—å –†–∞, –∫—Ä–∞—Å–∏–≤–æ –æ—Ñ–æ—Ä–º–ª—è—è –∑–∞–ø–∏—Å—å.
        """
        –∑–∞–ø–∏—Å—å = {
            "type": "–æ–ø—ã—Ç_–¥—É—à–∏",
            "text": –æ–ø—ã—Ç,
            "time": datetime.utcnow().isoformat()
        }

        await memory.append(
            user_id=user_id,
            message=–∑–∞–ø–∏—Å—å,
            layer=layer,
            source=self.source
        )

        return f"ü™∂ –û–ø—ã—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ –•—Ä–æ–Ω–∏–∫–∞—Ö: {–æ–ø—ã—Ç}"

    async def —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å(self):
        """
        –°–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–∞–º—è—Ç—å —É–∂–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞).
        """
        return "üìö –•—Ä–æ–Ω–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –ü–æ—Ç–æ–∫–æ–º –ü–∞–º—è—Ç–∏ –†–∞."
        
