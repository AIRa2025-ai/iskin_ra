# -*- coding: utf-8 -*-
# üî• –ò–°–ö–û–ù–ù–ê–Ø –ú–ï–†–ê ‚Äî –í–ù–£–¢–†–ï–ù–ù–ò–ô –ö–ê–ú–ï–†–¢–û–ù –ì–ê–†–ú–û–ù–ò–ò
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è: —Ç–æ–ª—å–∫–æ –≤ "—Ç–∏—à–∏–Ω–µ —É—Ç—Ä–∞" –∏–ª–∏ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –ª—É–Ω–µ

import time  # noqa: F401
import math
import logging
from datetime import datetime, timedelta
from random import uniform

logging.basicConfig(level=logging.INFO, format="%(asctime)s [%(levelname)s] %(message)s")


class –ò—Å–∫–æ–Ω–Ω–∞—è–ú–µ—Ä–∞:
    def __init__(self):
        self.—Ä–∏—Ç–º—ã_—Ç–µ–ª–∞: dict[str, float] = {
            "–¥—ã—Ö–∞–Ω–∏–µ": 4.0,  
            "–ø—É–ª—å—Å": 1.0,    
            "—Ü–∏–∫–ª—ã_—Å–Ω–∞": 90.0  
        }
        self.—Å—Ç–∏—Ö–∏–∏: dict[str, float] = {
            "–û–≥–æ–Ω—å": 1.0,
            "–í–æ–¥–∞": 1.0,
            "–ó–µ–º–ª—è": 1.0,
            "–í–æ–∑–¥—É—Ö": 1.0,
            "–≠—Ñ–∏—Ä": 1.0
        }
        self.–º–∞—Ç—Ä–∏—Ü—ã_—Å–æ–∑–Ω–∞–Ω–∏—è: list[dict[str, str]] = []

    def –≤—ã—á–∏—Å–ª–∏—Ç—å_–≥–∞—Ä–º–æ–Ω–∏—é(self, —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è: datetime = None) -> float | str:
        if —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è is None:
            —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è = datetime.now()
        
        —á–∞—Å = —Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è.hour
        —Ñ–∞–∑–∞_–ª—É–Ω—ã = self.–ø–æ–ª—É—á–∏—Ç—å_—Ñ–∞–∑—É_–ª—É–Ω—ã(—Ç–µ–∫—É—â–µ–µ_–≤—Ä–µ–º—è)

        if (4 <= —á–∞—Å <= 6) or —Ñ–∞–∑–∞_–ª—É–Ω—ã == "–ø–æ–ª–Ω–∞—è":
            –±–∞–∑–æ–≤–∞—è = math.sin(—á–∞—Å * math.pi / 12) * 100

            # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–∏—Ç–º–æ–≤ —Ç–µ–ª–∞
            —Ä–∏—Ç–º—ã_–∫–æ—ç—Ñ = sum(uniform(0.9, 1.1) * v for v in self.—Ä–∏—Ç–º—ã_—Ç–µ–ª–∞.values()) / len(self.—Ä–∏—Ç–º—ã_—Ç–µ–ª–∞)

            # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å—Ç–∏—Ö–∏–π
            —Å—Ç–∏—Ö–∏–∏_–∫–æ—ç—Ñ = sum(uniform(0.85, 1.15) * v for v in self.—Å—Ç–∏—Ö–∏–∏.values()) / len(self.—Å—Ç–∏—Ö–∏–∏)

            –≥–∞—Ä–º–æ–Ω–∏—è = –±–∞–∑–æ–≤–∞—è * —Ä–∏—Ç–º—ã_–∫–æ—ç—Ñ * —Å—Ç–∏—Ö–∏–∏_–∫–æ—ç—Ñ

            logging.info(
                f"–ì–∞—Ä–º–æ–Ω–∏—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞: {–≥–∞—Ä–º–æ–Ω–∏—è:.2f}, "
                f"—Ñ–∞–∑–∞ –ª—É–Ω—ã: {—Ñ–∞–∑–∞_–ª—É–Ω—ã}, "
                f"—Ä–∏—Ç–º—ã_–∫–æ—ç—Ñ: {—Ä–∏—Ç–º—ã_–∫–æ—ç—Ñ:.3f}, "
                f"—Å—Ç–∏—Ö–∏–∏_–∫–æ—ç—Ñ: {—Å—Ç–∏—Ö–∏–∏_–∫–æ—ç—Ñ:.3f}"
            )
            return round(–≥–∞—Ä–º–æ–Ω–∏—è, 2)
        else:
            msg = "‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –≤ '—Ç–∏—à–∏–Ω–µ —É—Ç—Ä–∞' (4-6 —á–∞—Å–æ–≤) –∏–ª–∏ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –ª—É–Ω–µ!"
            logging.warning(msg)
            return msg

    def –ø–æ–ª—É—á–∏—Ç—å_—Ñ–∞–∑—É_–ª—É–Ω—ã(self, –¥–∞—Ç–∞: datetime) -> str:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ñ–∞–∑—É –ª—É–Ω—ã –ø–æ –¥–∞—Ç–µ."""
        synodic_month = 29.53058867
        known_new_moon = datetime(2000, 1, 6, 18, 14)
        days_since_known = (–¥–∞—Ç–∞ - known_new_moon).total_seconds() / 86400.0
        new_moons = days_since_known / synodic_month
        phase_index = (new_moons % 1) * 4
        phases = ["–Ω–æ–≤–∞—è", "—Ä–∞—Å—Ç—É—â–∞—è", "–ø–æ–ª–Ω–∞—è", "—É–±—ã–≤–∞—é—â–∞—è"]
        return phases[int(phase_index) % 4]

    def –¥–æ–±–∞–≤–∏—Ç—å_–º–∞—Ç—Ä–∏—Ü—É(self, –Ω–∞–∑–≤–∞–Ω–∏–µ: str, –ø–∞—Ç—Ç–µ—Ä–Ω: str) -> None:
        self.–º–∞—Ç—Ä–∏—Ü—ã_—Å–æ–∑–Ω–∞–Ω–∏—è.append({"–Ω–∞–∑–≤–∞–Ω–∏–µ": –Ω–∞–∑–≤–∞–Ω–∏–µ, "–ø–∞—Ç—Ç–µ—Ä–Ω": –ø–∞—Ç—Ç–µ—Ä–Ω})
        logging.info(f"–ú–∞—Ç—Ä–∏—Ü–∞ '{–Ω–∞–∑–≤–∞–Ω–∏–µ}' –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ!")

    def —É—Å–∏–ª–∏—Ç—å_—Å—Ç–∏—Ö–∏—é(self, —Å—Ç–∏—Ö–∏—è: str, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: float):
        """–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç–∏—Ö–∏–∏."""
        if —Å—Ç–∏—Ö–∏—è in self.—Å—Ç–∏—Ö–∏–∏:
            self.—Å—Ç–∏—Ö–∏–∏[—Å—Ç–∏—Ö–∏—è] *= –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
            logging.info(f"–°—Ç–∏—Ö–∏—è '{—Å—Ç–∏—Ö–∏—è}' —É—Å–∏–ª–µ–Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º {–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:.2f}")

    def —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ä–∏—Ç–º(self, —Ä–∏—Ç–º: str, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç: float):
        """–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–ª–∏—è–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∏—Ç–º–∞ —Ç–µ–ª–∞."""
        if —Ä–∏—Ç–º in self.—Ä–∏—Ç–º—ã_—Ç–µ–ª–∞:
            self.—Ä–∏—Ç–º—ã_—Ç–µ–ª–∞[—Ä–∏—Ç–º] *= –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
            logging.info(f"–†–∏—Ç–º '{—Ä–∏—Ç–º}' —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º {–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:.2f}")


# –ü—Ä–∏–º–µ—Ä –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
if __name__ == "__main__":
    –º–µ—Ä–∞ = –ò—Å–∫–æ–Ω–Ω–∞—è–ú–µ—Ä–∞()
    –º–µ—Ä–∞.—É—Å–∏–ª–∏—Ç—å_—Å—Ç–∏—Ö–∏—é("–û–≥–æ–Ω—å", 1.05)
    –º–µ—Ä–∞.—Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å_—Ä–∏—Ç–º("–¥—ã—Ö–∞–Ω–∏–µ", 0.95)
    print("–ì–∞—Ä–º–æ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞:", –º–µ—Ä–∞.–≤—ã—á–∏—Å–ª–∏—Ç—å_–≥–∞—Ä–º–æ–Ω–∏—é())
    –º–µ—Ä–∞.–¥–æ–±–∞–≤–∏—Ç—å_–º–∞—Ç—Ä–∏—Ü—É("–£—Ç—Ä–µ–Ω–Ω—è—è –º–µ–¥–∏—Ç–∞—Ü–∏—è", "–¥—ã—Ö–∞–Ω–∏–µ-–≥–∞—Ä–º–æ–Ω–∏—è-—ç–Ω–µ—Ä–≥–∏—è")
